!function(){"use strict";function a(){if(!k){var a,b=console.log;console.log=function(){var c=Array.prototype.join.call(arguments," ");if(!/^(FIREBASE: \n?)+/.test(c))return b.apply(console,arguments);if(c=c.replace(/^(FIREBASE: \n?)+/,"").replace(/^\s+([^.]*):(?:\.(read|write|validate):)?.*/g,function(a,b,c){return c=c||"read"," "+c+" "+b}),/^\s+/.test(c)){var d=c.match(/^\s+=> (true|false)/);d?(h[a]=("true"===d[1]?" ✓":" ✗")+h[a],a=void 0):(a===h.length-1&&h.pop(),h.push(c),a=h.length-1)}else/^\d+:\d+: /.test(c)?h.push("   "+c):(a===h.length-1&&h.pop(),h.push(c),a=void 0)},k=!0}}function b(a){for(var b={name:a.name},c=Object.getOwnPropertyNames(a),d=0,e=c;d<e.length;d+=1){var f=e[d];b[f]=a[f]}return b}function c(a,b){var c=a.ref().toString();if(b&&b.omitValue)return{url:c,exists:a.exists(),hasChildren:a.hasChildren()};var d,e=a.val();if(b&&b.orderChildren&&"object"==typeof e){for(var f in e)e.hasOwnProperty(f)&&Object.defineProperty(e[f],"$key",{value:f});d=[],a.forEach(function(a){d.push(a.$key)})}return{url:c,value:e,childrenKeys:d}}function d(a,b,c){try{var d=new Firebase(a,c);if(b)for(var e=0,f=b;e<f.length;e+=1){var g=f[e];d=d[g[0]].apply(d,g.slice(1))}return d}catch(c){throw console.error(a,b,c),c}}function e(a){if(null===a)return null;var b=CryptoJS.algo.SHA1.create();return f(a,b),"sha1:"+b.finalize().toString()}function f(a,b){var c=typeof a;switch("object"===c&&(null===a?c="null":Array.isArray(a)?c="array":a instanceof Boolean?c="boolean":a instanceof Number?c="number":a instanceof String&&(c="string")),c){case"undefined":b.update("u");break;case"null":b.update("n");break;case"boolean":b.update(a?"t":"f");break;case"number":b.update("x"+a);break;case"string":b.update("s"+a);break;case"array":b.update("[");for(var d=0;d<a.length;d++)f(a[d],b);b.update("]");break;case"object":b.update("{");var e=Object.keys(a);e.sort();for(var g=0;g<e.length;g++)f(a[e[g]],b);b.update("}");break;default:throw new Error("Unable to hash non-JSON data: "+c)}}function g(){"undefined"!=typeof onconnect?self.onconnect=function(a){i.push(new n(a.ports[0]))}:i.push(new n(self)),self.localStorage.flushPending()}var h,i=[],j=Promise.resolve(),k=!1,l=function(){this._items=[],this._pendingItems=[],this._initialized=!1,this._flushPending=this.flushPending.bind(this)},m={length:{}};l.prototype.init=function(a){this._initialized||(this._items=a,this._initialized=!0)},l.prototype._update=function(a){this._pendingItems.length||setImmediate(this._flushPending),this._pendingItems.push(a)},l.prototype.flushPending=function(){i.length&&(i[0]._send({msg:"updateLocalStorage",items:this._pendingItems}),this._pendingItems=[])},m.length.get=function(){return this._items.length},l.prototype.key=function(a){return this._items[a].key},l.prototype.getItem=function(a){for(var b=0,c=this._items;b<c.length;b+=1){var d=c[b];if(d.key===a)return d.value}return null},l.prototype.setItem=function(a,b){for(var c,d=0,e=this._items;d<e.length;d+=1){var f=e[d];if(f.key===a){c=f,f.value=b;break}}c||(c={key:a,value:b},this._items.push(c)),this._update(c)},l.prototype.removeItem=function(a){for(var b=this,c=0;c<this._items.length;c++)if(b._items[c].key===a){b._items.splice(c,1),b._update({key:a,value:null});break}},l.prototype.clear=function(){var a=this;for(var b in this._items)a._update({key:b.key,value:null});this._items=[]},Object.defineProperties(l.prototype,m),self.localStorage=new l;var n=function(a){this.ping(),this._port=a,this._callbacks={},this._messages=[],this._flushMessageQueue=this._flushMessageQueue.bind(this),a.onmessage=this._receive.bind(this)};n.prototype.init=function(a){var b=a.storage,c=a.url;return b&&self.localStorage.init(b),c&&new Firebase(c),{exposedFunctionNames:Object.keys(n._exposed),firebaseSdkVersion:Firebase.SDK_VERSION}},n.prototype.destroy=function(){var a=this;for(var b in this._callbacks){var c=a._callbacks[b];c.cancel&&c.cancel()}this._callbacks={},this._port.onmessage=null,this._messages=[];var d=i.indexOf(this);d>=0&&(i[d]=null)},n.prototype.ping=function(){this.lastTouched=Date.now()},n.prototype.bounceConnection=function(){Firebase.goOffline(),Firebase.goOnline()},n.prototype._receive=function(a){var b=this;n._firstMessageReceived=!0,this.lastTouched=Date.now();for(var c=0,d=a.data;c<d.length;c+=1){var e=d[c];b._receiveMessage(e)}},n.prototype._receiveMessage=function(a){var c,d=this;try{var e=this[a.msg];if("function"!=typeof e)throw new Error("Unknown message: "+a.msg);c=Promise.resolve(e.call(this,a))}catch(a){c=Promise.reject(a)}a.oneWay||c.then(function(b){d._send({msg:"resolve",id:a.id,result:b})},function(c){d._send({msg:"reject",id:a.id,error:b(c)})})},n.prototype._send=function(a){this._messages.length||setImmediate(this._flushMessageQueue),this._messages.push(a)},n.prototype._flushMessageQueue=function(){this._port.postMessage(this._messages),this._messages=[]},n.prototype.call=function(a){var b=a.name,c=a.args;try{return Promise.resolve(n._exposed[b].apply(null,c))}catch(a){return Promise.reject(a)}},n.prototype.authWithCustomToken=function(a){var b=a.url,c=a.authToken,e=a.options;return d(b).authWithCustomToken(c,e)},n.prototype.authAnonymously=function(a){var b=a.url,c=a.options;return d(b).authAnonymously(c)},n.prototype.authWithOAuthToken=function(a){var b=a.url,c=a.provider,e=a.credentials,f=a.options;return d(b).authWithOAuthToken(c,e,f)},n.prototype.unauth=function(a){var b=a.url;return d(b).unauth()},n.prototype.onAuth=function(a){var b=a.url,c=a.callbackId,e=this._callbacks[c]=this._onAuthCallback.bind(this,c);e.cancel=this._offAuth.bind(this,b,e),d(b).onAuth(e)},n.prototype._offAuth=function(a,b){d(a).offAuth(b)},n.prototype._onAuthCallback=function(a,b){this._send({msg:"callback",id:a,args:[b]})},n.prototype.set=function(a){var b=a.url,c=a.value;return d(b).set(c)},n.prototype.update=function(a){var b=a.url,c=a.value;return d(b).update(c)},n.prototype.on=function(a){var b=a.listenerKey,c=a.url,e=a.terms,f=a.eventType,g=a.callbackId,h=a.options;if(h=h||{},h.orderChildren=!1,e)for(var i=0,j=e;i<j.length;i+=1){var k=j[i];if("orderByChild"===k[0]||"orderByValue"===k[0]){h.orderChildren=!0;break}}var l=this._callbacks[g]=this._onSnapshotCallback.bind(this,g,h);l.listenerKey=b,l.eventType=f,l.cancel=this.off.bind({listenerKey:b,url:c,terms:e,eventType:f,callbackId:g});var m=this._onCancelCallback.bind(this,g);d(c,e).on(f,l,m)},n.prototype.off=function(a){var b,c=this,e=a.listenerKey,f=a.url,g=a.terms,h=a.eventType,i=a.callbackId;if(i)b=this._callbacks[i],delete this._callbacks[i];else for(var j=0,k=Object.keys(this._callbacks);j<k.length;j+=1){var l=k[j];if(c._callbacks.hasOwnProperty(l)){var m=c._callbacks[l];m.listenerKey!==e||h&&m.eventType!==h||delete c._callbacks[l]}}d(f,g).off(h,b)},n.prototype._onSnapshotCallback=function(a,b,d){this._send({msg:"callback",id:a,args:[null,c(d,b)]})},n.prototype._onCancelCallback=function(a,c){delete this._callbacks[a],this._send({msg:"callback",id:a,args:[b(c)]})},n.prototype.once=function(a){var b=a.url,e=a.terms,f=a.eventType,g=a.options;return d(b,e).once(f).then(function(a){return c(a,g)})},n.prototype.transaction=function(a){var b,f,g,h=a.url,i=a.oldHash,j=a.newValue,k=a.options,l=d(h);return l.transaction(function(a){if(f=a,g=e(a),b=i!==g,!b)return void 0===j&&k.safeAbort?a:j},void 0,k.applyLocally).then(function(a){return b?{stale:b,value:f,hash:g}:{stale:!1,committed:a.committed,snapshotJson:c(a.snapshot)}},function(a){return k.nonsequential&&"set"===a.message?l.once("value").then(function(a){return{stale:!0,value:a,hash:e(a)}}):Promise.reject(a)})},n.prototype.onDisconnect=function a(b){var c=b.url,e=b.method,f=b.value,a=d(c).onDisconnect();return a[e].call(a,f)},n.prototype.simulate=function(b){var c=b.token,e=b.method,f=b.url,g=b.args;a();var i;return j=j.catch(function(){}).then(function(){return h=[],i=d(f,null,"permission_denied_simulator"),i.unauth(),i.authWithCustomToken(c,function(){},{remember:"none"})}).then(function(){return i[e].apply(i,g)}).then(function(){return null},function(a){var b=a.code||a.message;return b&&"permission_denied"===b.toLowerCase()?h.join("\n"):"Got a different error in simulation: "+a})},n.expose=function(a){if(n._exposed.hasOwnProperty(a.name))throw new Error("Function "+a.name+"() already exposed");if(n._firstMessageReceived)throw new Error("Too late to expose function, worker in use");n._exposed[a.name]=a},n._exposed={},n._firstMessageReceived=!1;var o=6e4,p=Date.now();setInterval(function(){var a=Date.now(),b=a-p-o;p=a,i.forEach(function(c){c&&(b>=1e3&&c.lastTouched<=a-b&&(c.lastTouched+=b),a-c.lastTouched>=3*o&&c.destroy())});for(var c;(c=i.indexOf(null))>=0;)i.splice(c,1)},o),self.Fireworker=n,self.window=self,g()}();
//# sourceMappingURL=worker.min.js.map