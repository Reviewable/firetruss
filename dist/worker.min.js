!function(){"use strict";function a(){if(!j){var a,b=console.log;console.log=function(){var c=Array.prototype.join.call(arguments," ");if(!/^(FIREBASE: \n?)+/.test(c))return b.apply(console,arguments);if(c=c.replace(/^(FIREBASE: \n?)+/,"").replace(/^\s+([^.]*):(?:\.(read|write|validate):)?.*/g,function(a,b,c){return c=c||"read"," "+c+" "+b}),/^\s+/.test(c)){var d=c.match(/^\s+=> (true|false)/);d?(g[a]=("true"===d[1]?" ✓":" ✗")+g[a],a=void 0):(a===g.length-1&&g.pop(),g.push(c),a=g.length-1)}else/^\d+:\d+: /.test(c)?g.push("   "+c):(a===g.length-1&&g.pop(),g.push(c),a=void 0)},j=!0}}function b(a){for(var b={name:a.name},c=Object.getOwnPropertyNames(a),d=0,e=c;d<e.length;d+=1){var f=e[d];b[f]=a[f]}return b}function c(a,b,c){try{var d=new Firebase(a,c);if(b){switch(b.by){case"$key":d=d.orderByKey();break;case"$value":d=d.orderByValue();break;default:d=d.orderByChild(b.by)}b.at?d=d.equalTo(b.at):b.from?d=d.startAt(b.from):b.to&&(d=d.endAt(b.to)),b.first?d=d.limitToFirst(b.first):b.last&&(d=d.limitToLast(b.last))}return d}catch(d){throw d.extra={url:a,spec:b,context:c},d}}function d(a){if(Array.isArray(a)){for(var b={},c=0;c<a.length;c++){var e=a[c];void 0!==e&&null!==e&&(b[c]=d(e))}return b}if(a instanceof Object)for(var f in a)a.hasOwnProperty(f)&&(a[f]=d(a[f]));return a}function e(a,b){if(a===b)return!0;if("object"!=typeof a||"object"!=typeof b)return!1;for(var c in a){if(!a.hasOwnProperty(c)||!b.hasOwnProperty(c))return!1;if(!e(a[c],b[c]))return!1}for(var d in b)if(!a.hasOwnProperty(d)||!b.hasOwnProperty(d))return!1;return!0}function f(){"undefined"!=typeof onconnect?self.onconnect=function(a){h.push(new n(a.ports[0]))}:h.push(new n(self)),self.localStorage.flushPending()}var g,h=[],i=Promise.resolve(),j=!1,k=function(){this._items=[],this._pendingItems=[],this._initialized=!1,this._flushPending=this.flushPending.bind(this)},l={length:{}};k.prototype.init=function(a){this._initialized||(this._items=a,this._initialized=!0)},k.prototype._update=function(a){this._pendingItems.length||setImmediate(this._flushPending),this._pendingItems.push(a)},k.prototype.flushPending=function(){h.length&&(h[0]._send({msg:"updateLocalStorage",items:this._pendingItems}),this._pendingItems=[])},l.length.get=function(){return this._items.length},k.prototype.key=function(a){return this._items[a].key},k.prototype.getItem=function(a){for(var b=0,c=this._items;b<c.length;b+=1){var d=c[b];if(d.key===a)return d.value}return null},k.prototype.setItem=function(a,b){for(var c,d=0,e=this._items;d<e.length;d+=1){var f=e[d];if(f.key===a){c=f,f.value=b;break}}c||(c={key:a,value:b},this._items.push(c)),this._update(c)},k.prototype.removeItem=function(a){for(var b=this,c=0;c<this._items.length;c++)if(b._items[c].key===a){b._items.splice(c,1),b._update({key:a,value:null});break}},k.prototype.clear=function(){var a=this;for(var b in this._items)a._update({key:b.key,value:null});this._items=[]},Object.defineProperties(k.prototype,l),self.localStorage=new k;var m=function(){this._root=null};m.prototype.set=function(a){this._root=a},m.prototype.diff=function(a,b){var c={},d="/"===b?[""]:b.split("/");return this._diffRecursively(this._root,a,d,c)&&(this._root=a,c[b]=a),c},m.prototype._diffRecursively=function(a,b,c,d){var e=this;if(void 0===a&&(a=null),void 0===b&&(b=null),null===a)return null!==b;if(!(a instanceof Object&&b instanceof Object))return b!==a;var f=!0,g=[];for(var h in b)b.hasOwnProperty(h)&&(e._diffRecursively(a[h],b[h],c.concat(h),d)?g.push(h):f=!1);if(f)return!0;for(var i in a)a.hasOwnProperty(i)&&!b.hasOwnProperty(i)&&(d[c.concat(i).join("/")]=null,delete a[i]);for(var j=0,k=g;j<k.length;j+=1){var l=k[j];d[c.concat(l).join("/")]=b[l],a[l]=b[l]}};var n=function(a){this.ping(),this._port=a,this._lastWriteSerial=0,this._callbacks={},this._messages=[],this._flushMessageQueue=this._flushMessageQueue.bind(this),a.onmessage=this._receive.bind(this)};n.prototype.init=function(a){var b=a.storage,d=a.url;return b&&self.localStorage.init(b),d&&c(d),{exposedFunctionNames:Object.keys(n._exposed),firebaseSdkVersion:Firebase.SDK_VERSION}},n.prototype.destroy=function(){var a=this;for(var b in this._callbacks){var c=a._callbacks[b];c.cancel&&c.cancel()}this._callbacks={},this._port.onmessage=null,this._messages=[];var d=h.indexOf(this);d>=0&&(h[d]=null)},n.prototype.ping=function(){this.lastTouched=Date.now()},n.prototype.bounceConnection=function(){Firebase.goOffline(),Firebase.goOnline()},n.prototype._receive=function(a){var b=this;n._firstMessageReceived=!0,this.lastTouched=Date.now();for(var c=0,d=a.data;c<d.length;c+=1){var e=d[c];b._receiveMessage(e)}},n.prototype._receiveMessage=function(a){var c,d=this;try{var e=this[a.msg];if("function"!=typeof e)throw new Error("Unknown message: "+a.msg);a.writeSerial&&(this._lastWriteSerial=a.writeSerial),c=Promise.resolve(e.call(this,a))}catch(a){c=Promise.reject(a)}a.oneWay||(this._send({msg:"acknowledge",id:a.id}),c.then(function(b){d._send({msg:"resolve",id:a.id,result:b})},function(c){d._send({msg:"reject",id:a.id,error:b(c)})}))},n.prototype._send=function(a){this._messages.length||setImmediate(this._flushMessageQueue),this._messages.push(a)},n.prototype._flushMessageQueue=function(){this._port.postMessage(this._messages),this._messages=[]},n.prototype.call=function(a){var b=a.name,c=a.args;try{return Promise.resolve(n._exposed[b].apply(null,c))}catch(a){return Promise.reject(a)}},n.prototype.authWithCustomToken=function(a){var b=a.url,d=a.authToken,e=a.options;return c(b).authWithCustomToken(d,e)},n.prototype.unauth=function(a){var b=a.url;return c(b).unauth()},n.prototype.onAuth=function(a){var b=a.url,d=a.callbackId,e=this._callbacks[d]=this._onAuthCallback.bind(this,d);e.cancel=this._offAuth.bind(this,b,e),c(b).onAuth(e)},n.prototype._offAuth=function(a,b){c(a).offAuth(b)},n.prototype._onAuthCallback=function(a,b){this._send({msg:"callback",id:a,args:[b]})},n.prototype.set=function(a){var b=a.url,d=a.value;return c(b).set(d)},n.prototype.update=function(a){var b=a.url,d=a.value;return c(b).update(d)},n.prototype.on=function(a){var b=a.listenerKey,d=a.url,e=a.spec,f=a.eventType,g=a.callbackId,h=a.options;h=h||{},h.sync&&(h.branch=new m);var i=this._callbacks[g]=this._onSnapshotCallback.bind(this,g,h);i.listenerKey=b,i.eventType=f,i.cancel=this.off.bind(this,{listenerKey:b,url:d,spec:e,eventType:f,callbackId:g});var j=this._onCancelCallback.bind(this,g);c(d,e).on(f,i,j),h.sync&&(h.omitValue=!0)},n.prototype.off=function(a){var b,d=this,e=a.listenerKey,f=a.url,g=a.spec,h=a.eventType,i=a.callbackId;if(i)b=this._callbacks[i],delete this._callbacks[i];else for(var j=0,k=Object.keys(this._callbacks);j<k.length;j+=1){var l=k[j];if(d._callbacks.hasOwnProperty(l)){var m=d._callbacks[l];m.listenerKey!==e||h&&m.eventType!==h||delete d._callbacks[l]}}c(f,g).off(h,b)},n.prototype._onSnapshotCallback=function(a,c,e){var f=this;if(c.sync&&c.rest){var g,h=decodeURIComponent(e.ref().toString().replace(/.*?:\/\/[^\/]*/,"").replace(/\/$/,""));try{g=d(e.val())}catch(d){c.branch.set(null),this._send({msg:"callback",id:a,args:[null,{path:h,exists:e.exists(),valueError:b(d)}]})}var i=this.options.branch.diff(g,h);for(var j in i)i.hasOwnProperty(j)&&f._send({msg:"callback",id:a,args:[null,{path:j,value:i[j]}]})}else{var k=this._snapshotToJson(e,c);c.sync&&c.branch.set(k.value),this._send({msg:"callback",id:a,args:[null,k]}),c.rest=!0}},n.prototype._onCancelCallback=function(a,c){delete this._callbacks[a],this._send({msg:"callback",id:a,args:[b(c)]})},n.prototype.transaction=function(a){var b,f=a.url,g=a.oldValue,h=a.relativeUpdates,i=c(f);return i.transaction(function(a){if(a=d(a),b=!e(a,g),!b){if(h)for(var c in h)if(h.hasOwnProperty(c))if(c){var f=c.split("/");void 0!==a&&null!==a||(a={});for(var i=a,j=0;j<f.length-1;j++){var k=f[j],l=i[k];void 0!==l&&null!==l||(l=i[k]={}),i=l}i[f[f.length-1]]=h[c]}else a=h[c];return a}}).then(function(a){return!b},function(a){return"set"!==a.message&&"disconnect"!==a.message&&Promise.reject(a)})},n.prototype._snapshotToJson=function(a,c){var e=decodeURIComponent(a.ref().toString().replace(/.*?:\/\/[^\/]*/,"").replace(/\/$/,""));if(c&&c.omitValue)return{path:e,exists:a.exists(),writeSerial:this._lastWriteSerial};try{return{path:e,value:d(a.val()),writeSerial:this._lastWriteSerial}}catch(c){return{path:e,exists:a.exists(),valueError:b(c),writeSerial:this._lastWriteSerial}}},n.prototype.onDisconnect=function a(b){var d=b.url,e=b.method,f=b.value,a=c(d).onDisconnect();return a[e].call(a,f)},n.prototype.simulate=function(b){var d=b.token,e=b.method,f=b.url,h=b.args;a();var j;return i=i.catch(function(){}).then(function(){return g=[],j=c(f,null,"permission_denied_simulator"),j.unauth(),j.authWithCustomToken(d,function(){},{remember:"none"})}).then(function(){return j[e].apply(j,h)}).then(function(){return null},function(a){var b=a.code||a.message;return b&&"permission_denied"===b.toLowerCase()?g.join("\n"):"Got a different error in simulation: "+a})},n.expose=function(a,b){if(b=b||a.name,!b)throw new Error("Cannot expose a function with no name: "+a);if(n._exposed.hasOwnProperty(b))throw new Error("Function "+b+"() already exposed");if(n._firstMessageReceived)throw new Error("Too late to expose function, worker in use");n._exposed[b]=a},n._exposed={},n._firstMessageReceived=!1;var o=6e4,p=Date.now();setInterval(function(){var a=Date.now(),b=a-p-o;p=a,h.forEach(function(c){c&&(b>=1e3&&c.lastTouched<=a-b&&(c.lastTouched+=b),a-c.lastTouched>=3*o&&c.destroy())});for(var c;(c=h.indexOf(null))>=0;)h.splice(c,1)},o),self.Fireworker=n,self.window=self,f()}();
//# sourceMappingURL=worker.min.js.map