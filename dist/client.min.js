!function(){"use strict";function a(a,b){return b?a.then(function(a){b(a)},function(a){b(a)}):a}function b(a){if(!a||a instanceof Error)return a;var b=new Error;for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function c(){}var d,e="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",f=1<<31,g=2147483647,h=function(a){var b=a.url,c=a.childrenKeys,d=a.value,e=a.exists,f=a.hasChildren;this._url=b.replace(/\/$/,""),this._childrenKeys=c,this._value=d,this._exists=e,this._hasChildren=f};h.prototype.exists=function(){return this._exists},h.prototype.val=function(){return this._checkValue(),this._value},h.prototype.child=function a(b){var c=b.split("/"),a=this._getChildValue(c);return new h({url:this._url+"/"+c.map(encodeURIComponent).join("/"),value:a,exists:void 0!==a,hasChildren:"object"==typeof a})},h.prototype.forEach=function(a){var b=this;if(this._checkValue(),!this._hasChildren)return!1;if(!this._childrenKeys){this._childrenKeys=Object.keys(this._value);for(var c={},d=0,e=this._childrenKeys;d<e.length;d+=1){var i=e[d];if(/^[+-]?\d+$/.test(i)){var j=parseInt(i,10);if(j<=g&&j>=f){c[i]=j;continue}}c[i]=i}this._childrenKeys.sort(function(a,b){a=c[a],b=c[b];var d="number"==typeof a,e="number"==typeof b;return d^e?d?-1:1:a===b?0:a<b?-1:1})}for(var k=0,l=this._childrenKeys;k<l.length;k+=1){var m=l[k],n=b._value[m],o=new h({url:b._url+"/"+m,value:n,exists:void 0!==n,hasChildren:"object"==typeof n});if(a(o)===!0)return!0}return!1},h.prototype.hasChild=function(a){return null!==this._getChildValue(a.split("/"))},h.prototype.hasChildren=function(){return this._hasChildren},h.prototype.key=function(){return this._url.replace(/.*\//,"")},h.prototype.numChildren=function(){return this._checkValue(),this._childrenKeys?this._childrenKeys.length:0},h.prototype.ref=function(){return new j(this._url)},h.prototype._checkValue=function(){if(void 0===this._value)throw new Error("Value omitted from snapshot")},h.prototype._getChildValue=function(a){this._checkValue();for(var b=this._value,c=0,d=a;c<d.length;c+=1){var e=d[c];if(null===b||void 0===b)break;b=b[e]}return void 0===b&&(b=null),b};var i=function(a,b){if(!d)throw new Error("Worker not connected");if("https://"!==a.slice(0,8))throw new Error('Firebase URL must start with "https://"');this._url=a.replace(/\/$/,""),this._terms=b};i.prototype.on=function(a,b,c,e,f){return"undefined"===e&&"function"!=typeof c&&(e=c,c=void 0),d.on(this.toString(),this._url,this._terms,a,b,c,e,f),b},i.prototype.off=function(a,b,c){return d.off(this.toString(),this._url,this._terms,a,b,c)},i.prototype.once=function(a,b,c,e){return"undefined"===e&&"function"!=typeof c&&(e=c,c=void 0),d.once(this._url,this._terms,a,b,c,e)},i.prototype.ref=function(){return new j(this._url)},i.prototype.toString=function(){var a=this._url;if(this._terms){var b=this._terms.map(function(a){var b=a[0];return a.length>1&&(b+="="+encodeURIComponent(a.slice(1).join(","))),b});b.sort(),a+="?"+b.join("&")}return a},["orderByChild","orderByKey","orderByValue","startAt","endAt","equalTo","limitToFirst","limitToLast"].forEach(function(a){i.prototype[a]=function(){var b=Array.prototype.slice.call(arguments);b.unshift(a);var c=this._terms?this._terms.slice():[];return c.push(b),new i(this._url,c)}});var j=function(b){function c(a){b.call(this,a),d.trackServer(this.root()._url)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.authWithCustomToken=function(b,c,e){return e||"object"!=typeof c||(e=c,c=null),a(d.authWithCustomToken(this._url,b,e),c)},c.prototype.authAnonymously=function(b,c){return c||"object"!=typeof b||(c=b,b=null),a(d.authAnonymously(this._url,c),b)},c.prototype.authWithOAuthToken=function(b,c,e,f){return f||"object"!=typeof e||(f=e,e=null),a(d.authWithCustomToken(this._url,b,c,f),e)},c.prototype.authWithPassword=function(){throw new Error("Interactive auth not supported by Fireworker")},c.prototype.authWithOAuthPopup=function(){throw new Error("Interactive auth not supported by Fireworker")},c.prototype.authWithOAuthRedirect=function(){throw new Error("Interactive auth not supported by Fireworker")},c.prototype.unauth=function(){return d.unauth(this._url)},c.prototype.onAuth=function(a,b){d.onAuth(this.root()._url,a,b)},c.prototype.offAuth=function(a,b){d.offAuth(this.root()._url,a,b)},c.prototype.getAuth=function(){return d.getAuth(this.root()._url)},c.prototype.child=function(a){return new c(this._url+"/"+a.split("/").map(encodeURIComponent).join("/"))},c.prototype.parent=function(){var a=this._url.lastIndexOf("/");return a>=8?new c(this._url.slice(0,a)):null},c.prototype.root=function(){var a=this._url.indexOf("/",8);return a>=8?new c(this._url.slice(0,a)):this},c.prototype.key=function(){return this._url.replace(/.*\//,"")},c.prototype.set=function(b,c){return a(d.set(this._url,b),c)},c.prototype.update=function(b,c){return a(d.update(this._url,b),c)},c.prototype.remove=function(b){return a(d.set(this._url,null),b)},c.prototype.push=function(b,c){var e=this.child(d.generateUniqueKey(this.root()));if(!b)return e;var f=a(d.set(e,b),c);return e.then=f.then.bind(f),e.catch=f.catch.bind(f),f.finally&&(e.finally=f.finally.bind(f)),e},c.prototype.transaction=function(a,b,c){throw new Error("Not implemented")},c.connectWorker=function(a){if(d)throw new Error("Worker already connected");d=new k(a)},c.goOnline=function(){throw new Error("Global goOnline() call must be made from within the worker process")},c.goOffline=function(){throw new Error("Global goOffline() call must be made from within the worker process")},c}(i);j.ServerValue=Object.freeze({TIMESTAMP:Object.freeze({".sv":"timestamp"})});var k=function(a){var b=this;this._idCounter=0,this._deferreds={},this._online=!0,this._servers={},this._callbacks={},this._port=a.port||a,this._port.onmessage=this.receive.bind(this),this._send({msg:"init"}).then(function(a){for(var c=window.Firebase.worker={},d=0,e=a;d<e.length;d+=1){var f=e[d];c[f]=b._bindExposedFunction(f)}})};k.prototype._send=function(a){var b=this;a.id=++this._idCounter;var c=new Promise(function(c,d){b._deferreds[a.id]={resolve:c,reject:d}});return this._deferreds[a.id].promise=c,this._port.postMessage(a),c},k.prototype._receive=function(a){this[a.data.msg](a.data)},k.prototype._bindExposedFunction=function(a){return function(){return this._send({msg:"call",name:a,args:Array.prototype.slice(arguments)})}.bind(this)},k.prototype.resolve=function(a){var b=this._deferreds[a.id];if(!b)throw new Error("fireworker received resolution to inexistent call");delete this._deferreds[a.id],b.resolve(a.result)},k.prototype.reject=function(a){var c=this._deferreds[a.id];if(!c)throw new Error("fireworker received rejection of inexistent call");delete this._deferreds[a.id],c.reject(b(a.error))},k.prototype.trackServer=function(a){if(!this._servers.hasOwnProperty(a)){var b=this._servers[a]={offset:0,lastUniqueKeyTime:0,lastRandomValues:[],authListeners:[]},c=this._registerCallback(this._authCallback.bind(this,b));this.on(a+"/.info/serverTimeOffset",{},"value",function(a){b.offset=a}),this._send({msg:"onAuth",url:a,callbackId:c})}},k.prototype.generateUniqueKey=function(a){var b=this._servers[a];if(!b)throw new Error("Internal assertion failure: server not initialized for "+a);for(var c=Date.now()+b.offset,d=new Array(20),f=c,g=7;g>=0;g--)d[g]=e.charAt(63&f),f>>>=6;if(c===b.lastUniqueKeyTime){for(var h=11;h>=0&&63===b.lastRandomValues[h];)b.lastRandomValues[h]=0,h-=1;if(h===-1)throw new Error("Internal assertion failure: ran out of unique IDs for this millisecond");b.lastRandomValues[h]+=1}else for(var i=0;i<12;i++)b.lastRandomValues[i]=Math.floor(Math.random()*(i?64:16));for(var j=0;j<12;j++)d[j+8]=e[b.lastRandomValues[j]];return d.join("")},k.prototype._authCallback=function(a,b){a.auth=b;for(var c=0,d=a.authListeners;c<d.length;c+=1){var e=d[c];e(b)}},k.prototype.onAuth=function(a,b,c){var d=b.bind(c);d.callback=b,d.context=c,this._servers[a].authListeners.push(d),d(this.getAuth())},k.prototype.offAuth=function(a,b,c){for(var d=this._servers[a].authListeners,e=0;e<d.length;e++){var f=d[e];if(f.callback===b&&f.context===c){d.splice(e,1);break}}},k.prototype.getAuth=function(a){return this._servers[a].auth},k.prototype.authWithCustomToken=function(a,b,c){return this._send({msg:"authWithCustomToken",url:a,authToken:b,options:c})},k.prototype.authAnonymously=function(a,b){return this._send({msg:"authAnonymously",url:a,options:b})},k.prototype.authWithOAuthToken=function(a,b,c,d){return this._send({msg:"authWithOAuthToken",url:a,provider:b,credentials:c,options:d})},k.prototype.unauth=function(a){return this._send({msg:"unauth",url:a})},k.prototype.set=function(a,b){return this._send({msg:"set",url:a,value:b})},k.prototype.update=function(a,b){return this._send({msg:"update",url:a,value:b})},k.prototype.on=function(a,b,c,d,e,f,g,h){var i={listenerKey:a,eventType:d,snapshotCallback:e,cancelCallback:f,context:g},j=this._onCallback.bind(this,i);i.id=this._registerCallback(j),e.__callbackIds=e.__callbackIds||[],e.__callbackIds.push(i.id),this._send({msg:"on",listenerKey:a,url:b,terms:c,eventType:d,callbackId:i.id,options:h}).catch(function(a){j(a)})},k.prototype.off=function(a,b,c,d,e,f){var g,h=this,i=[];if(e){if(e.__callbackIds)for(var j=0;j<e.__callbackIds.length;){var k=e.__callbackIds[j],l=h._callbacks[k];if(l){if(l.listenerKey===a&&l.eventType===d&&l.context===f){g=k,i.push(k),e.__callbackIds.splice(j,1);break}j+=1}else e.__callbackIds.splice(j,1)}}else for(var m=0,n=Object.keys(this._callbacks);m<n.length;m+=1){var o=n[m],p=h._callbacks[o];p.listenerKey!==a||d&&p.eventType!==d||i.push(o)}for(var q=0,r=i;q<r.length;q+=1){var s=r[q];h._nullifyCallback(s)}return this._send({msg:"off",url:b,terms:c,eventType:d,callbackId:g}).then(function(){for(var a=0,b=i;a<b.length;a+=1){var c=b[a];h._deregisterCallback(c)}})},k.prototype._onCallback=function(a,c,d){c?(this._deregisterCallback(a.id),a.cancelCallback&&a.cancelCallback.call(a.context,b(c))):a.snapshotCallback(new h(d))},k.prototype.callback=function a(b){var c=b.id,d=b.args,a=this._callbacks[c];if(!a)throw new Error("Unregistered callback: "+c);a.apply(null,d)},k.prototype._registerCallback=function(a){var b="c"+ ++this._idCounter;return this._callbacks[b]=a,b},k.prototype._nullifyCallback=function(a){this._callbacks[a]=c},k.prototype._deregisterCallback=function(a){delete this._callbacks[a]},window.Firebase=j}();
//# sourceMappingURL=client.min.js.map